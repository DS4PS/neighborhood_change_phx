<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Kendelle Brown &amp; Abby Henderson" />


<title>Phoenix Neighborhoods Data</title>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type="text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Phoenix Neighborhoods Data</h1>
<h4 class="author">Kendelle Brown &amp; Abby Henderson</h4>
<h4 class="date">4/14/2019</h4>

</div>


<pre class="r"><code># Load libraries

library(knitr, quietly=TRUE)
library(dplyr, quietly=TRUE)</code></pre>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<pre class="r"><code>library(pander, quietly=TRUE)
library(devtools, quietly=TRUE)
library(censusapi, quietly=TRUE)</code></pre>
<pre><code>## 
## Attaching package: 'censusapi'</code></pre>
<pre><code>## The following object is masked from 'package:methods':
## 
##     getFunction</code></pre>
<pre class="r"><code>library(maptools, quietly=TRUE)</code></pre>
<pre><code>## Checking rgeos availability: TRUE</code></pre>
<pre class="r"><code>library(rgdal, quietly=TRUE)</code></pre>
<pre><code>## rgdal: version: 1.4-3, (SVN revision 828)
##  Geospatial Data Abstraction Library extensions to R successfully loaded
##  Loaded GDAL runtime: GDAL 2.1.3, released 2017/20/01
##  Path to GDAL shared files: /Library/Frameworks/R.framework/Versions/3.5/Resources/library/rgdal/gdal
##  GDAL binary built with GEOS: FALSE 
##  Loaded PROJ.4 runtime: Rel. 4.9.3, 15 August 2016, [PJ_VERSION: 493]
##  Path to PROJ.4 shared files: /Library/Frameworks/R.framework/Versions/3.5/Resources/library/rgdal/proj
##  Linking to sp version: 1.3-1</code></pre>
<pre class="r"><code>library(geojsonio, quietly=TRUE)</code></pre>
<pre><code>## 
## Attaching package: 'geojsonio'</code></pre>
<pre><code>## The following object is masked from 'package:devtools':
## 
##     lint</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     pretty</code></pre>
<pre class="r"><code>library(rmapshaper, quietly=TRUE)
library(sf, quietly=TRUE)</code></pre>
<pre><code>## Linking to GEOS 3.6.1, GDAL 2.1.3, PROJ 4.9.3</code></pre>
<pre class="r"><code>library(ggplot2, quietly=TRUE)
library(tidyr, quietly=TRUE)
library(viridis, quietly=TRUE)
library(gridExtra, quietly=TRUE)</code></pre>
<pre><code>## 
## Attaching package: 'gridExtra'</code></pre>
<pre><code>## The following object is masked from 'package:dplyr':
## 
##     combine</code></pre>
<pre class="r"><code>library(rmapshaper, quietly=TRUE)
library( sp, quietly=TRUE)
library(rgeos, quietly=TRUE)</code></pre>
<pre><code>## rgeos version: 0.4-2, (SVN revision 581)
##  GEOS runtime version: 3.6.1-CAPI-1.10.1 
##  Linking to sp version: 1.3-1 
##  Polygon checking: TRUE</code></pre>
<pre class="r"><code>library(mapproj, quietly=TRUE)
library(ggmap, quietly=TRUE)</code></pre>
<pre><code>## Google's Terms of Service: https://cloud.google.com/maps-platform/terms/.</code></pre>
<pre><code>## Please cite ggmap if you use it! See citation(&quot;ggmap&quot;) for details.</code></pre>
<pre class="r"><code>library(scales, quietly=TRUE)</code></pre>
<pre><code>## 
## Attaching package: 'scales'</code></pre>
<pre><code>## The following object is masked from 'package:viridis':
## 
##     viridis_pal</code></pre>
<pre class="r"><code>library(RColorBrewer, quietly=TRUE)

#Load in census key
##Census Key
censuskey &lt;- &quot;20f2773e863a33466e0fbace2116919a1c67e4a5&quot;

setwd(&quot;../data&quot;)

# Load Meta data

## Read csv file with all filtered variables. 
Metadata_2010_ACS5 &lt;- read.csv(&quot;./raw/2010ACS5DataDictionary.csv&quot;)
Metadata_2015_ACS5 &lt;- read.csv(&quot;./raw/2015ACS5DataDictionary.csv&quot;)

#Load time series tables
NHGIS_data &lt;- read.csv(&quot;./raw/NHGIS_geog_data.csv&quot;)</code></pre>
<pre class="r"><code>#Manipulate NHGIS data to rename and create percentages



NHGIS_data &lt;- rename(NHGIS_data, NotHispanic.Latino_1990=CP4AA1990, NotHispanic.Latino_2000=CP4AA2000, NotHispanic.Latino_2010=CP4AA2010, Hispanic.Latino1990=CP4AB1990, Hispanic.Latino2000=CP4AB2000, Hispanic.Latino2010=CP4AB2010)

# Rename Racial Variables


NHGIS_data &lt;- rename(NHGIS_data, White_1990=CM1AA1990, White_2000=CM1AA2000, White_2010=CM1AA2010, Black_AA_1990=CM1AB1990, Black_AA_2000=CM1AB2000, Black_AA_2010=CM1AB2010, NativeAm_Alaskan1990=CM1AC1990, NativeAm_Alaskan2000=CM1AC2000,NativeAm_Alaskan2010=CM1AC2010, Asian_1990=CM1AD1990,Asian_2000=CM1AD2000, Asian_2010=CM1AD2010, NativeHawaiian.PacificIslander_1990=CM1AE1990,NativeHawaiian.PacificIslander_2000=CM1AE2000, NativeHawaiian.PacificIslander_2010=CM1AE2010, SomeOther_1990=CM1AF1990, SomeOther_2000=CM1AF2000, SomeOther_2010=CM1AF2010, Two.OrMore_1990=CM1AG1990, Two.OrMore_2000=CM1AG2000, Two.OrMore_2010=CM1AG2010 )

# Rename Number of Units Variables

NHGIS_data &lt;- rename(NHGIS_data, HousingUnits_1990=CM7AA1990, HousingUnits_2000=CM7AA2000, HousingUnits_2010=CM7AA2010)

# Rename Occupancy Variable 

NHGIS_data &lt;- rename(NHGIS_data, HousingUnits_Occupied_1990=CM9AA1990, HousingUnits_Occupied_2000=CM9AA2000, HousingUnits_Occupied_2010=CM9AA2010, HousingUnits_Vacant_1990=CM9AB1990, HousingUnits_Vacant_2000=CM9AB2000, HousingUnits_Vacant_2010=CM9AB2010)

# Rename Vacancy Status Variables 

NHGIS_data &lt;- rename(NHGIS_data, Vacant_ForRent_1990=CN0AA1990, Vacant_ForRent_2000=CN0AA2000, Vacant_ForRent_2010=CN0AA2010, Vacant_ForSale_1990=CN0AB1990, Vacant_ForSale_2000=CN0AB2000, Vacant_ForSale_2010=CN0AB2010, Vacant_RentedOrSold_1990=CN0AC1990, Vacant_RentedOrSold_2000=CN0AC2000, Vacant_RentedOrSold_2010=CN0AC2010, Vacant_OccasionalUse_1990=CN0AD1990, Vacant_OccasionalUse_2000=CN0AD2000, Vacant_OccasionalUse_2010=CN0AD2010, Vacant_MigrantWorkers_1990=CN0AE1990, Vacant_MigrantWorkers_2000=CN0AE2000, Vacant_MigrantWorkers_2010=CN0AE2010, Vacant_Other_1990=CN0AF1990, Vacant_Other_2000=CN0AF2000, Vacant_Other_2010=CN0AF2010)

# Rename Sex Variables 

NHGIS_data &lt;- rename(NHGIS_data, Male_1990=CM0AA1990, 
Male_2000=CM0AA2000,
Male_2010=CM0AA2010, 
Female_1990=CM0AB1990,
Female_2000=CM0AB2000,
Female_2010=CM0AB2010)

# Rename Age Variables 

NHGIS_data &lt;- rename(NHGIS_data, Under5years_1990=CW3AA1990, 
Under5years_2000=CW3AA2000,
Under5years_2010=CW3AA2010, 
Ages5to9_1990=CW3AB1990,
Ages5to9_2000=CW3AB2000,
Ages5to9_2010=CW3AB2010,
Ages10to14_1990=CW3AC1990,
Ages10to14_2000=CW3AC2000,
Ages10to14_2010=CW3AC2010,
Ages15to17_1990=CW3AD1990,
Ages15to17_2000=CW3AD2000,
Ages15to17_2010=CW3AD2010,
Ages25to29_1990=CW3AI1990,
Ages25to29_2000=CW3AI2000,
Ages25to29_2010=CW3AI2010)

# Combine ages 18&amp;19, 20, 21, 22-24. Rename &quot;College Age&quot;
NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(CollegeAge_1990 = coalesce(CW3AE1990 + CW3AF1990 + CW3AG1990 + CW3AH1990))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(CollegeAge_2000 = coalesce(CW3AE2000 + CW3AF2000 + CW3AG2000 + CW3AH2000))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(CollegeAge_2010 = coalesce(CW3AE2010 + CW3AF2010 + CW3AG2010 + CW3AH2010))

#Combine 30s, rename Age30s
NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age30s_1990 = coalesce(CW3AJ1990 + CW3AK1990))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age30s_2000 = coalesce(CW3AJ2000 + CW3AK2000))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age30s_2010 = coalesce(CW3AJ2010 + CW3AK2010))

#Combine 40s, rename Age40s
NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age40s_1990 = coalesce(CW3AL1990 + CW3AM1990))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age40s_2000 = coalesce(CW3AL2000 + CW3AM2000))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age40s_2010 = coalesce(CW3AL2010 + CW3AM2010))

#Combine 50s, rename Age50s
NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age50s_1990 = coalesce(CW3AN1990 + CW3AO1990))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age50s_2000 = coalesce(CW3AN2000 + CW3AO2000))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age50s_2010 = coalesce(CW3AN2010 + CW3AO2010))

#Combine 60s, rename Age60s
NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age60s_1990 = coalesce(CW3AP1990 + CW3AQ1990 + CW3AR1990))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age60s_2000 = coalesce(CW3AP2000 + CW3AQ2000 + CW3AR2000))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age60s_2010 = coalesce(CW3AP2010 + CW3AQ2010 + CW3AR2010))

#Combine 70s, rename Age70s
NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age70s_1990 = coalesce(CW3AS1990 + CW3AT1990))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age70s_2000 = coalesce(CW3AS2000 + CW3AT2000))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age70s_2010 = coalesce(CW3AS2010 + CW3AT2010))

#Combine 80s, rename Age80andOver
NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age80sandOver_1990 = coalesce(CW3AU1990 + CW3AV1990))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age80sandOver_2000 = coalesce(CW3AU2000 + CW3AV2000))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(Age80sandOver_2010 = coalesce(CW3AU2010 + CW3AV2010))

# Occupancy and Vacancy 
# Create percentage variables of each Occupancy category

NHGIS_data &lt;- NHGIS_data %&gt;% group_by(TRACTA) %&gt;% 
  mutate((OccupiedHousingUnits_Percent_1990 = HousingUnits_Occupied_1990
 / HousingUnits_1990) * 100) %&gt;%
  mutate(( OccupiedHousingUnits_Percent_2000 = HousingUnits_Occupied_2000
 / HousingUnits_2000) * 100) %&gt;%
mutate(( OccupiedHousingUnits_Percent_2010 = HousingUnits_Occupied_2010
 / HousingUnits_2010) * 100) %&gt;% 
mutate(( VacantHousingUnits_Percent_1990 = HousingUnits_Vacant_1990
 / HousingUnits_1990 ) * 100) %&gt;%
mutate(( VacantHousingUnits_Percent_2000 = HousingUnits_Vacant_2000
 / HousingUnits_2000 ) * 100) %&gt;%
mutate(( VacantHousingUnits_Percent_2010 = HousingUnits_Vacant_2010
 / HousingUnits_2010 ) * 100) %&gt;%
  mutate((forsale_percent_1990 = Vacant_ForSale_1990 / HousingUnits_1990 )* 100 ) %&gt;%
  mutate((forsale_percent_2000 = Vacant_ForSale_2000 / HousingUnits_2000 ) * 100) %&gt;%
  mutate((forsale_percent_2010 = Vacant_ForSale_2010 / HousingUnits_2010 ) * 100)

# Ethnicity 
#Combine Hispanic and Not Hispanic to get an Ethnicity population count

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(TotalEthnicityCount_1990 = coalesce(NotHispanic.Latino_1990 + Hispanic.Latino1990))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(TotalEthnicityCount_2000 = coalesce(NotHispanic.Latino_2000 + Hispanic.Latino2000))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(TotalEthnicityCount_2010 = coalesce(NotHispanic.Latino_2010 + Hispanic.Latino2010))

# Create percentage variables of Ethnicity category

NHGIS_data &lt;- NHGIS_data %&gt;% group_by(TRACTA) %&gt;% 
  mutate((Hispanic.Latino_Percent_1990 = Hispanic.Latino1990
 / TotalEthnicityCount_1990) * 100) %&gt;%
  mutate(( NotHispanic.Latino_Percent_1990 = NotHispanic.Latino_1990
 / TotalEthnicityCount_1990) * 100) %&gt;%
mutate(( Hispanic.Latino_Percent_2000 = Hispanic.Latino2000 
 / TotalEthnicityCount_2000) * 100) %&gt;% 
mutate(( NotHispanic.Latino_Percent_2000 = NotHispanic.Latino_2000
 / TotalEthnicityCount_2000 ) * 100) %&gt;%
mutate(( Hispanic.Latino_Percent_2010 = Hispanic.Latino2010 
 / TotalEthnicityCount_2010 ) * 100) %&gt;%
mutate(( NotHispanic.Latino_Percent_2010 = NotHispanic.Latino_2010 
 / TotalEthnicityCount_2010 ) * 100)

# Sex
#Combine Male and Female to get a population count

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(TotalSexPopulation_1990 = coalesce(Male_1990 + Female_1990))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(TotalSexPopulation_2000 = coalesce(Male_2000 + Female_2000))

NHGIS_data &lt;- NHGIS_data %&gt;%
  mutate(TotalSexPopulation_2010 = coalesce(Male_2010 + Female_2010))

# Create percentage variables of Sex category

NHGIS_data &lt;- NHGIS_data %&gt;% group_by(TRACTA) %&gt;% 
  mutate((Male_Percent_1990 = Male_1990
 / TotalSexPopulation_1990) * 100) %&gt;%
  mutate(( Female_Percent_1990 = Female_1990 / TotalSexPopulation_1990) * 100) %&gt;%
mutate(( Male_Percent_2000 = Male_2000 / TotalSexPopulation_2000) * 100) %&gt;% 
mutate(( Female_Percent_2000 = Female_2000 / TotalSexPopulation_2000 ) * 100) %&gt;%
mutate(( Male_Percent_2010 = Male_2010 
 / TotalSexPopulation_2010 ) * 100) %&gt;%
mutate(( Female_Percent_2010 = Female_2010 / TotalSexPopulation_2010 ) * 100)

# Write new CSV File
write.csv( NHGIS_data, &quot;NHGIS_data_rename.csv&quot;, row.names=F)</code></pre>
<div id="manipulate-acs-data" class="section level1">
<h1>Manipulate ACS data</h1>
<pre class="r"><code>##2015

## Variable list

race_2015_vars &lt;- read.csv(&quot;variable_lists/race_2015_ACS5.csv&quot;)

## Download data
### Create Variable list based off variables in the first column
var.list.race.2015 &lt;- race_2015_vars$name

### Pull Data using variable list only. Make sure the censusapi package is loaded.
race.pop.2015 &lt;- getCensus( name = &quot;acs/acs5&quot;, vintage = 2015,
                            key=censuskey,
                               vars = var.list.race.2015,
                               region=&quot;tract:*&quot;,
                            regionin=&quot;state:04&amp;county:013&quot; )

## Rename variables
### Rename data
race.pop.2015 &lt;- rename(race.pop.2015, 
                        Total_2015=B25006_001E, 
                        White_2015=B02001_002E, 
                        Black_2015=B02001_003E,
                        American_Indian_2015=B02001_004E,
                        Asian_2015=B02001_005E ,
                        Pacific_Islander_2015=B02001_006E,
                        Two_plus_races_2015= B02001_008E,
                        Other_Race_2015=B02001_007E,
                         Not_hispanic_2015= B03003_002E,
                         Hispanic_2015= B03003_003E)

### Add Percentages

race.pop.2015 &lt;- race.pop.2015 %&gt;% group_by(tract) %&gt;% 
  mutate(( White_Percent_2015 = White_2015 / Total_2015) * 100) %&gt;%
mutate(( Black_Percent_2015 = Black_2015 / Total_2015) * 100) %&gt;% 
mutate(( Indian_Percent_2015 = American_Indian_2015 / Total_2015 ) * 100) %&gt;%
mutate(( Asian_Percent_2015 = Asian_2015 / Total_2015 ) * 100) %&gt;%
mutate(( Pacific_Islander_Percent_2015 = Pacific_Islander_2015 / Total_2015 ) * 100) %&gt;%
mutate(( Two_plus_racesPercent_2015 = Two_plus_races_2015 / Total_2015 ) * 100) %&gt;%
mutate(( Other_Percent_2015 = Other_Race_2015 / Total_2015 ) * 100) %&gt;%
  mutate(( Hispanic_percent_2015 = Hispanic_2015 / Total_2015) * 100 ) %&gt;%
  mutate((Not_hispanic_percent_2015 = Not_hispanic_2015 / Total_2015) * 100)

##Geoid
###Create GEOID of FIPS Code elements
race_geoid_2015 &lt;- paste0( race.pop.2015$state, race.pop.2015$county, race.pop.2015$tract)

race.pop.2015$geoid &lt;- race_geoid_2015

# Sex

##1990, 2000, and 2010


##2015
###Read csv file with only age variables. I created this by selecting variables from the Metadata and putting them into a separate csv file. Unfortunately, there was no &quot;Sex&quot; alone variables, so I selected Total sex estimates from a different concept.

sex_vars_2015 &lt;- read.csv(&quot;variable_lists/sex_vars_2015.csv&quot;)</code></pre>
<pre><code>## Warning in read.table(file = file, header = header, sep = sep, quote =
## quote, : incomplete final line found by readTableHeader on 'variable_lists/
## sex_vars_2015.csv'</code></pre>
<pre class="r"><code>### Create Variable list based off variables in the first column
sex.list.2015 &lt;- sex_vars_2015$name
sex.pop.2015 &lt;- getCensus( name = &quot;acs/acs5&quot;, vintage = 2015,
                           key=censuskey,
                               vars = sex.list.2015,
                               region=&quot;tract:*&quot;,
                           regionin=&quot;state:04&amp;county:013&quot; )

#Rename the variables
sex.pop.2015 &lt;- rename(sex.pop.2015,
                       Total_sex_2015= B01001_001E,
                         Male_2015= B01001_002E,
                         Female_2015= B01001_026E)
###Create GEOID of FIPS Code elements
sex_geoid_2015 &lt;- paste0( sex.pop.2015$state, sex.pop.2015$county, sex.pop.2015$tract)

sex.pop.2015$geoid &lt;- sex_geoid_2015

# Education

##2010 and 2015

###Read csv file with only race variables. I manually created this by cutting and pasting the rows I wanted from the previous spreadsheet. 
educ_2010_vars &lt;- read.csv(&quot;variable_lists/educ_2010_vars.csv&quot;)

### Create Variable list based off variables in the first column
var.list.educ.2010 &lt;- educ_2010_vars$name

educ.pop.2010 &lt;- getCensus( name = &quot;acs/acs5&quot;, vintage = 2010,
                            key=censuskey,
                               vars = var.list.educ.2010,
                               region=&quot;tract:*&quot;,
                            regionin=&quot;state:04&amp;county:013&quot; )


educ.pop.2010 &lt;- rename(educ.pop.2010, Total_2010=B15002_001E,
                        No_school_2010_M=B15002_003E,
                        Fourth_2010_M=B15002_004E,
                         Sixth_2010_M=B15002_005E,
                        Eighth_2010_M=B15002_006E, 
                        Ninth_2010_M=B15002_007E,
                        Tenth_2010_M= B15002_008E,
                       Eleventh_2010_M=B15002_009E,
                       Twelfth_NO_2010_M=B15002_010E,
                       HSD_GED_2010_M=B15002_011E,
                       SomeCollege_0yr_2010_M=B15002_012E,
                       SomeCollege_1yr_2010_M=B15002_013E,
                       AA_2010_M=B15002_014E,
                       BA_2010_M=B15002_015E,
                       Masters_2010_M=B15002_016E,
                       ProfSchool_2010_M=B15002_017E,
                       Doctoral_2010_M=B15002_018E,
                        No_school_2010_F=B15002_020E,
                       Fourth_2010_F=B15002_021E,
                        Sixth_2010_F=B15002_022E,
                       Eighth_2010_F=B15002_023E, 
                        Ninth_2010_F=B15002_024E,
                       Tenth_2010_F=B15002_025E,
                       Eleventh_2010_F=B15002_026E,
                       Twelfth_NO_2010_F=B15002_027E,
                       HSD_GED_2010_F=B15002_028E,
                       SomeCollege_0yr_2010_F=B15002_029E,
                       SomeCollege_1yr_2010_F=B15002_030E,
                       AA_2010_F=B15002_031E,
                       BA_2010_F=B15002_032E,
                       Masters_2010_F=B15002_033E,
                       ProfSchool_2010_F=B15002_034E,
                       Doctoral_2010_F=B15002_035E)


###Combine variable categories as necessary, including combining Male and Female to get a population count.

educ.pop.2010 &lt;- educ.pop.2010 %&gt;%
  mutate(LessThanNinth_2010 = coalesce(Fourth_2010_M + Fourth_2010_F + Sixth_2010_M + Sixth_2010_F + Eighth_2010_M +  Eighth_2010_F))

educ.pop.2010 &lt;- educ.pop.2010 %&gt;%
  mutate(NoSchool_2010 = coalesce(No_school_2010_F + No_school_2010_M))

educ.pop.2010 &lt;- educ.pop.2010 %&gt;%
  mutate(Ninthgrade_2010 = coalesce(Ninth_2010_M + Ninth_2010_F))

educ.pop.2010 &lt;- educ.pop.2010 %&gt;%
  mutate(Tenthgrade_2010 = coalesce(Tenth_2010_M+ Tenth_2010_F))

educ.pop.2010 &lt;- educ.pop.2010 %&gt;%
  mutate(Eleventhgrade_2010 = coalesce(Eleventh_2010_M + Eleventh_2010_F))

educ.pop.2010 &lt;- educ.pop.2010 %&gt;%
  mutate(Twelfthgrade_2010 = coalesce(Twelfth_NO_2010_M + Twelfth_NO_2010_F))

educ.pop.2010 &lt;- educ.pop.2010 %&gt;%
  mutate(HSDiploma_GED_2010 = coalesce(HSD_GED_2010_M + HSD_GED_2010_F))

educ.pop.2010 &lt;- educ.pop.2010 %&gt;%
  mutate(SomeCollege_2010 = coalesce(SomeCollege_0yr_2010_M +
                                       SomeCollege_1yr_2010_M +
                                       SomeCollege_0yr_2010_F +
                                       SomeCollege_1yr_2010_F))

educ.pop.2010 &lt;- educ.pop.2010 %&gt;%
  mutate(AA_2010 = coalesce(AA_2010_M + AA_2010_F))

educ.pop.2010 &lt;- educ.pop.2010 %&gt;%
  mutate(BA_2010 = coalesce(BA_2010_M + BA_2010_F))

educ.pop.2010 &lt;- educ.pop.2010 %&gt;%
  mutate(Masters_2010 = coalesce(Masters_2010_M + Masters_2010_F))

educ.pop.2010 &lt;- educ.pop.2010 %&gt;%
  mutate(ProfSchool_2010 = coalesce(ProfSchool_2010_M + ProfSchool_2010_F))

educ.pop.2010 &lt;- educ.pop.2010 %&gt;%
  mutate(Doctoral_2010 = coalesce(Doctoral_2010_M + Doctoral_2010_F))

educ.pop.2010 &lt;- educ.pop.2010 %&gt;%
  mutate(hs_above_2010 = coalesce(HSD_GED_2010_M + HSD_GED_2010_F +  SomeCollege_0yr_2010_M + SomeCollege_0yr_2010_F + SomeCollege_1yr_2010_M + AA_2010_M +  AA_2010_F + BA_2010_M + BA_2010_F +  Masters_2010_M + Masters_2010_F + ProfSchool_2010_M + ProfSchool_2010_F + Doctoral_2010_M + Doctoral_2010_F))


###Create percentage variables of each educational category

educ.pop.2010 &lt;- educ.pop.2010 %&gt;% group_by(tract) %&gt;% 
  mutate((No_school_Percent_2010 = NoSchool_2010 / Total_2010) * 100) %&gt;%
  mutate(( LessThanNinth_Percent_2010 = LessThanNinth_2010 / Total_2010) * 100) %&gt;%
mutate(( Ninthgrade_Percent_2010 = Ninthgrade_2010 / Total_2010) * 100) %&gt;% 
mutate(( Tenthgrade_Percent_2010 = Tenthgrade_2010 / Total_2010 ) * 100) %&gt;%
mutate(( Eleventhgrade_Percent_2010 = Eleventhgrade_2010 / Total_2010 ) * 100) %&gt;%
mutate(( Twelfthgrade_Percent_2010 = Twelfthgrade_2010 / Total_2010 ) * 100) %&gt;%
mutate(( HSD_GED_Percent_2010 = HSDiploma_GED_2010 / Total_2010 ) * 100) %&gt;%
mutate(( SomeCollege_Percent_2010 = SomeCollege_2010  / Total_2010 ) * 100) %&gt;%
mutate(( AA_Percent_2010 = AA_2010 / Total_2010 ) * 100) %&gt;%
mutate(( BA_Percent_2010 = BA_2010 / Total_2010 ) * 100) %&gt;%
mutate(( Masters_Percent_2010 = Masters_2010 / Total_2010 ) * 100) %&gt;%
mutate(( ProfSchool_Percent_2010 = ProfSchool_2010 / Total_2010 ) * 100) %&gt;%
mutate(( Doctoral_Percent_2010 = Doctoral_2010 / Total_2010 ) * 100) %&gt;%
  mutate(( hs_above_Percent_2010 = hs_above_2010 / Total_2010) * 100)

### Geoid

#Create GEOID of FIPS Code elements
educ_geoid_2010 &lt;- paste0( educ.pop.2010$state, educ.pop.2010$county, educ.pop.2010$tract)

educ.pop.2010$geoid &lt;- educ_geoid_2010

###Read csv file with only race variables. I manually created this by cutting and pasting the rows I wanted from the previous spreadsheet. 
educ_2015_vars &lt;- read.csv(&quot;variable_lists/educ_2015_vars.csv&quot;)

### Create Variable list based off variables in the first column
var.list.educ.2015 &lt;- educ_2015_vars$name


### Pull Data using variable list only. 
educ.pop.2015 &lt;- getCensus( name = &quot;acs/acs5&quot;, vintage = 2015,
                            key=censuskey,
                               vars = var.list.educ.2015,
                               region=&quot;tract:*&quot;,
                            regionin=&quot;state:04&amp;county:013&quot; )

### Rename data
educ.pop.2015 &lt;- rename(educ.pop.2015, Total_2015=B15003_001E,
                        No_school_2015=B15003_002E,
                        Prek_2015=B15003_003E,
                        Kinder_2015=B15003_004E,
                        Firstgrade_2015=B15003_005E, 
                        Secondgrade_2015=B15003_006E, 
                        Thirdgrade_2015= B15003_007E,
                       Fourthgrade_2015=B15003_008E,
                       Fifthgrade_2015=B15003_009E,
                       Sixthgrade_2015=B15003_010E,
                       Seventhgrade_2015=B15003_011E,
                       Eighthgrade_2015=B15003_012E,
                       Ninthgrade_2015=B15003_013E,
                       Tenthgrade_2015=B15003_014E,
                       Eleventhgrade_2015=B15003_015E,
                       Twelfthgrade_2015=B15003_016E,
                       HSdiploma_2015=B15003_017E,
                       GED_2015=B15003_018E,
                       Somecollege_0yr_2015=B15003_019E,
                       Somecollege_1yr_2015=B15003_020E,
                       AA_2015=B15003_021E,
                       Bachelors_2015=B15003_022E,
                       Masters_2015=B15003_023E,
                       ProfSchool_2015=B15003_024E,
                       Doctoral_2015=B15003_025E)


### Combine Categories as necessary to make meaningful categories

educ.pop.2015 &lt;- educ.pop.2015 %&gt;%
  mutate(LessThanNinth_2015 = coalesce(Prek_2015 + Kinder_2015 + Firstgrade_2015 + Secondgrade_2015 + Thirdgrade_2015 +  Fourthgrade_2015 + Fifthgrade_2015 + Sixthgrade_2015 + Seventhgrade_2015 + Eighthgrade_2015))

educ.pop.2015 &lt;- educ.pop.2015 %&gt;% 
  mutate(SomeCollege_2015 = coalesce(Somecollege_0yr_2015 + Somecollege_1yr_2015))

educ.pop.2015 &lt;- educ.pop.2015 %&gt;%
  mutate(hs_above_2015 = coalesce(HSdiploma_2015 + GED_2015 + Somecollege_0yr_2015 + Somecollege_1yr_2015 + AA_2015 +  Bachelors_2015 + Masters_2015 + ProfSchool_2015 + Doctoral_2015))

### Add Percentages

educ.pop.2015 &lt;- educ.pop.2015 %&gt;% group_by(tract) %&gt;% 
  mutate((No_school_Percent_2015 = No_school_2015 / Total_2015) * 100) %&gt;%
  mutate(( LessThanNinth_Percent_2015 = LessThanNinth_2015 / Total_2015) * 100) %&gt;%
mutate(( Ninthgrade_Percent_2015 = Ninthgrade_2015 / Total_2015) * 100) %&gt;% 
mutate(( Tenthgrade_Percent_2015 = Tenthgrade_2015 / Total_2015 ) * 100) %&gt;%
mutate(( Eleventhgrade_Percent_2015 = Eleventhgrade_2015 / Total_2015 ) * 100) %&gt;%
mutate(( Twelfthgrade_Percent_2015 = Twelfthgrade_2015 / Total_2015 ) * 100) %&gt;%
mutate(( HSDiploma_Percent_2015 = HSdiploma_2015 / Total_2015 ) * 100) %&gt;%
mutate(( GED_Percent_2015 = GED_2015 / Total_2015 ) * 100) %&gt;%
mutate(( SomeCollege_Percent_2015 = SomeCollege_2015  / Total_2015 ) * 100) %&gt;%
mutate(( AA_Percent_2015 = AA_2015 / Total_2015 ) * 100) %&gt;%
mutate(( Bachelors_Percent_2015 = Bachelors_2015 / Total_2015 ) * 100) %&gt;%
mutate(( Masters_Percent_2015 = Masters_2015 / Total_2015 ) * 100) %&gt;%
mutate(( ProfSchool_Percent_2015 = ProfSchool_2015 / Total_2015 ) * 100) %&gt;%
mutate(( Doctoral_Percent_2015 = Doctoral_2015 / Total_2015 ) * 100) %&gt;%
mutate(( hs_above_percent_2015 = hs_above_2015 / Total_2015) * 100)

###Geo id
#Create GEOID of FIPS Code elements
educ_geoid_2015 &lt;- paste0( educ.pop.2015$state, educ.pop.2015$county, educ.pop.2015$tract)

educ.pop.2015$geoid &lt;- educ_geoid_2015

# Income

##2010 and 2015

### Read csv file with only race variables. 
income_2010_vars &lt;- read.csv(&quot;variable_lists/income_2010_vars.csv&quot;)

### Create Variable list based off variables in the first column
var.list.income.2010 &lt;- income_2010_vars$name

###Download the data
income.pop.2010 &lt;- getCensus( name = &quot;acs/acs5&quot;, vintage = 2010,
                              key=censuskey,
                               vars = var.list.income.2010,
                               region=&quot;tract:*&quot;,
                              regionin=&quot;state:04&amp;county:013&quot; )

##Rename the variables
income.pop.2010 &lt;- rename(income.pop.2010, Total_income_2010=B19001_001E,
                        Lessthan10k_income_2010=B19001_002E, 
                        TenkTo14k_income_2010=B19001_003E,
                        Fifteenkto20k_income_2010=B19001_004E,
                        TwentykTo25k_income_2010=B19001_005E, 
                        TwentyfivekTo30k_income_2010=B19001_006E, 
                        ThirtykTo35k_income_2010= B19001_007E,
                       ThirtyfivekTo40k_income_2010=B19001_008E,
                       FortykTo45k_income_2010=B19001_009E,
                       FortyfivekTo50k_income_2010=B19001_010E,
                       FiftykTo60k_income_2010=B19001_011E,
                       SixtykTo75k_income_2010=B19001_012E, 
                       SeventyfivekTo100k_income_2010=B19001_013E,
                       OnehundredkTo125k_income_2010=B19001_014E, 
                       OnetwentyfivekTo150k_income_2010=B19001_015E,
                       OnefiftykTo200k_income_2010=B19001_016E, 
                       TwohundredkPlus_income_2010=B19001_017E)

###Combine variable categories as necessary.
income.pop.2010 &lt;- income.pop.2010 %&gt;%
  mutate(OnetwentyfivekPlus_income_2010 = coalesce(OnehundredkTo125k_income_2010 + OnefiftykTo200k_income_2010 + TwohundredkPlus_income_2010))


income.pop.2010 &lt;- income.pop.2010 %&gt;%
  mutate(belowpoverty_2010 = coalesce(Lessthan10k_income_2010 + TenkTo14k_income_2010 + Fifteenkto20k_income_2010))

###Create percentage variables of each educational category
income.pop.2010 &lt;- income.pop.2010 %&gt;% group_by(tract) %&gt;% 
  mutate((Lessthan10k_Percent_2010 = Lessthan10k_income_2010 / Total_income_2010) * 100) %&gt;%
  mutate(( TenkTo14k_Percent_2010 = TenkTo14k_income_2010 / Total_income_2010) * 100) %&gt;%
mutate(( TenkTo14k_Percent_2010 = TenkTo14k_income_2010 / Total_income_2010) * 100) %&gt;% 
mutate(( Fifteenkto20k_Percent_2010 = Fifteenkto20k_income_2010 / Total_income_2010 ) * 100) %&gt;%
mutate(( TwentykTo25k_Percent_2010 = TwentykTo25k_income_2010 / Total_income_2010 ) * 100) %&gt;%
mutate(( TwentyfivekTo30k_Percent_2010 = TwentyfivekTo30k_income_2010 / Total_income_2010 ) * 100) %&gt;%
mutate(( ThirtykTo35k_2010 = ThirtykTo35k_income_2010 / Total_income_2010 ) * 100) %&gt;%
mutate(( ThirtyfivekTo40k_Percent_2010 = ThirtyfivekTo40k_income_2010  / Total_income_2010 ) * 100) %&gt;%
mutate(( FortykTo45k_Percent_2010 = FortykTo45k_income_2010 / Total_income_2010 ) * 100) %&gt;%
mutate(( FortyfivekTo50k_Percent_2010 = FortyfivekTo50k_income_2010 / Total_income_2010 ) * 100) %&gt;%
mutate(( FiftykTo60k_Percent_2010 = FiftykTo60k_income_2010 / Total_income_2010 ) * 100) %&gt;%
mutate(( SixtykTo75k_Percent_2010 = SixtykTo75k_income_2010 / Total_income_2010 ) * 100) %&gt;%
mutate(( SeventyfivekTo100k_Percent_2010 = SeventyfivekTo100k_income_2010 / Total_income_2010 ) * 100) %&gt;%
mutate(( OnehundredkTo125k_Percent_2010 = OnehundredkTo125k_income_2010 / Total_income_2010 ) * 100) %&gt;%
mutate(( OnetwentyfivekTo150k_Percent_2010 = OnetwentyfivekTo150k_income_2010 / Total_income_2010 ) * 100) %&gt;%
mutate(( OnefiftykTo200k_Percent_2010 = OnefiftykTo200k_income_2010 / Total_income_2010 ) * 100) %&gt;%
mutate(( TwohundredkPlus_Percent_2010 = TwohundredkPlus_income_2010 / Total_income_2010 ) * 100)%&gt;%
  mutate(( belowpoverty_percent_2010 = belowpoverty_2010 / Total_income_2010 ) * 100)

###Create GEOID of FIPS Code elements
income_geoid_2010 &lt;- paste0( income.pop.2010$state, income.pop.2010$county, income.pop.2010$tract)
income.pop.2010$geoid &lt;- income_geoid_2010

###Read csv file with only income variables for 2015. 
income_2015_vars &lt;- read.csv(&quot;variable_lists/income_2015_vars.csv&quot;)

### Create Variable list based off variables in the first column
var.list.income.2015 &lt;- income_2015_vars$name

### Pull Data using variable list only. Make sure the censusapi package is loaded.
income.pop.2015 &lt;- getCensus( name = &quot;acs/acs5&quot;, vintage = 2015,
                              key=censuskey,
                               vars = var.list.income.2015,
                               region=&quot;tract:*&quot;,
                              regionin=&quot;state:04&amp;county:013&quot; )
### Rename data
income.pop.2015 &lt;- rename(income.pop.2015,
                      Total_income_2015=B19001_001E,
                        Lessthan10k_income_2015=B19001_002E, 
                        TenkTo14k_income_2015=B19001_003E,
                        Fifteenkto20k_income_2015=B19001_004E,
                        TwentykTo25k_income_2015=B19001_005E, 
                        TwentyfivekTo30k_income_2015=B19001_006E, 
                        ThirtykTo35k_income_2015= B19001_007E,
                       ThirtyfivekTo40k_income_2015=B19001_008E,
                       FortykTo45k_income_2015=B19001_009E,
                       FortyfivekTo50k_income_2015=B19001_010E,
                       FiftykTo60k_income_2015=B19001_011E,
                       SixtykTo75k_income_2015=B19001_012E, 
                       SeventyfivekTo100k_income_2015=B19001_013E,
                       OnehundredkTo125k_income_2015=B19001_014E, 
                       OnetwentyfivekTo150k_income_2015=B19001_015E,
                       OnefiftykTo200k_income_2015=B19001_016E, 
                       TwohundredkPlus_income_2015=B19001_017E)

###Combine Categories
income.pop.2015 &lt;- income.pop.2015 %&gt;%
  mutate(OnetwentyfivekPlus_income_2015 = coalesce(OnehundredkTo125k_income_2015 + OnefiftykTo200k_income_2015 + TwohundredkPlus_income_2015))

income.pop.2015 &lt;- income.pop.2015 %&gt;%
  mutate(belowpoverty_2015 = coalesce(Lessthan10k_income_2015 + TenkTo14k_income_2015 + Fifteenkto20k_income_2015))

### Add Percentages
income.pop.2015 &lt;- income.pop.2015 %&gt;% group_by(tract) %&gt;% 
  mutate((Lessthan10k_Percent_2015 = Lessthan10k_income_2015 / Total_income_2015) * 100) %&gt;%
  mutate(( TenkTo14k_Percent_2015 = TenkTo14k_income_2015 / Total_income_2015) * 100) %&gt;%
mutate(( TenkTo14k_Percent_2015 = TenkTo14k_income_2015 / Total_income_2015) * 100) %&gt;% 
mutate(( Fifteenkto20k_Percent_2015 = Fifteenkto20k_income_2015 / Total_income_2015 ) * 100) %&gt;%
mutate(( TwentykTo25k_Percent_2015 = TwentykTo25k_income_2015 / Total_income_2015 ) * 100) %&gt;%
mutate(( TwentyfivekTo30k_Percent_2015 = TwentyfivekTo30k_income_2015 / Total_income_2015 ) * 100) %&gt;%
mutate(( ThirtykTo35k_Percent_2015 = ThirtykTo35k_income_2015 / Total_income_2015 ) * 100) %&gt;%
mutate(( ThirtyfivekTo40k_Percent_2015 = ThirtyfivekTo40k_income_2015  / Total_income_2015 ) * 100) %&gt;%
mutate(( FortykTo45k_Percent_2015 = FortykTo45k_income_2015 / Total_income_2015 ) * 100) %&gt;%
mutate(( FortyfivekTo50k_Percent_2015 = FortyfivekTo50k_income_2015 / Total_income_2015 ) * 100) %&gt;%
mutate(( FiftykTo60k_Percent_2015 = FiftykTo60k_income_2015 / Total_income_2015 ) * 100) %&gt;%
mutate(( SixtykTo75k_Percent_2015 = SixtykTo75k_income_2015 / Total_income_2015 ) * 100) %&gt;%
mutate(( SeventyfivekTo100k_Percent_2015 = SeventyfivekTo100k_income_2015 / Total_income_2015 ) * 100) %&gt;%
mutate(( OnehundredkTo125k_Percent_2015 = OnehundredkTo125k_income_2015 / Total_income_2015 ) * 100) %&gt;%
mutate(( OnetwentyfivekTo150k_Percent_2015 = OnetwentyfivekTo150k_income_2015 / Total_income_2015 ) * 100) %&gt;%
mutate(( OnefiftykTo200k_Percent_2015 = OnefiftykTo200k_income_2015 / Total_income_2015 ) * 100) %&gt;%
mutate(( TwohundredkPlus_Percent_2015 = TwohundredkPlus_income_2015 / Total_income_2015 ) * 100) %&gt;%
  mutate(( belowpoverty_percent_2015 = belowpoverty_2015 / Total_income_2015 ) * 100)

###Create GEOID of FIPS Code elements
income_geoid_2015 &lt;- paste0( income.pop.2015$state, income.pop.2015$county, income.pop.2015$tract)

income.pop.2015$geoid &lt;- income_geoid_2015


# Value

##2010 and 2015

###Read csv file with only race variables. I manually created this by cutting and pasting the rows I wanted from the previous spreadsheet. 
value_2010_vars &lt;- read.csv(&quot;variable_lists/value_vars_2010.csv&quot;)


### Create Variable list based off variables in the first column
var.list.value.2010 &lt;- value_2010_vars$name

##Download the data
value.pop.2010 &lt;- getCensus( name = &quot;acs/acs5&quot;, vintage = 2010,
                             key=censuskey,
                               vars = var.list.value.2010,
                               region=&quot;tract:*&quot;,
                             regionin=&quot;state:04&amp;county:013&quot; )

##Rename variables
value.pop.2010 &lt;- rename(value.pop.2010,
                         Total_value_2010=B25075_001E,
                        Lessthan10k_value_2010=B25075_002E, 
                        TenkTo14k_value_2010=B25075_003E,
                        Fifteenkto20k_value_2010=B25075_004E,
                        TwentykTo25k_value_2010=B25075_005E, 
                        TwentyfivekTo30k_value_2010=B25075_006E, 
                        ThirtykTo35k_value_2010= B25075_007E,
                       ThirtyfivekTo40k_value_2010=B25075_008E,
                       FortykTo50k_value_2010=B25075_009E,
                       FiftykTo60k_value_2010=B25075_010E,
                       SixtykTo70k_value_2010=B25075_011E, 
                       SeventykTo80k_value_2010=B25075_012E,
                       Eightykto90k_value_2010=B25075_013E,
                       Ninetykto100k_value_2010=B25075_014E,
                       OnehundredkTo125k_value_2010=B25075_015E, 
                       OnetwentyfivekTo150k_value_2010=B25075_016E,
                       OnefiftykTo175k_value_2010=B25075_017E, 
                       One75kTo200k_value_2010=B25075_018E, 
                       Twohundredkto250k_value_2010=B25075_019E, 
                       Twofiftykto300k_value_2010=B25075_020E, 
                       Threehundredkto400k_value_2010=B25075_021E, 
                       Fourhundredkto500k_value_2010=B25075_022E, 
                       Fivehundredkto750k_value_2010=B25075_023E, 
                       Sevenfiftykto1mil_value_2010=B25075_024E, 
                       OnemilPlus_value_2010=B25075_025E)

###Create percentage variables of each educational category
value.pop.2010 &lt;- value.pop.2010 %&gt;% group_by(tract) %&gt;% 
  mutate((Lessthan10k_Percent_2010 = Lessthan10k_value_2010 / Total_value_2010) * 100) %&gt;%
  mutate(( TenkTo14k_Percent_2010 = TenkTo14k_value_2010 / Total_value_2010) * 100) %&gt;%
mutate(( TenkTo14k_Percent_2010 = TenkTo14k_value_2010 / Total_value_2010) * 100) %&gt;% 
mutate(( Fifteenkto20k_Percent_2010 = Fifteenkto20k_value_2010 / Total_value_2010 ) * 100) %&gt;%
mutate(( TwentykTo25k_Percent_2010 = TwentykTo25k_value_2010 / Total_value_2010 ) * 100) %&gt;%
mutate(( TwentyfivekTo30k_Percent_2010 = TwentyfivekTo30k_value_2010 / Total_value_2010 ) * 100) %&gt;%
mutate(( ThirtykTo35k_2010 = ThirtykTo35k_value_2010 / Total_value_2010 ) * 100) %&gt;%
mutate(( ThirtyfivekTo40k_Percent_2010 = ThirtyfivekTo40k_value_2010  / Total_value_2010 ) * 100) %&gt;%
mutate(( FortykTo50k_Percent_2010 = FortykTo50k_value_2010 / Total_value_2010 ) * 100) %&gt;%
mutate(( FiftykTo60k_Percent_2010 = FiftykTo60k_value_2010 / Total_value_2010 ) * 100) %&gt;%
mutate(( SixtykTo70k_Percent_2010 = SixtykTo70k_value_2010 / Total_value_2010 ) * 100) %&gt;%
mutate((  Eightykto90k_Percent_2010 =  Eightykto90k_value_2010 / Total_value_2010 ) * 100) %&gt;%
mutate(( Ninetykto100k_Percent_2010 = Ninetykto100k_value_2010 / Total_value_2010 ) * 100) %&gt;%
mutate(( OnehundredkTo125k_Percent_2010 = OnehundredkTo125k_value_2010 / Total_value_2010 ) * 100) %&gt;%
mutate(( OnetwentyfivekTo150k_Percent_2010 = OnetwentyfivekTo150k_value_2010 / Total_value_2010 ) * 100) %&gt;%
mutate(( OnefiftykTo175k_Percent_2010 = OnefiftykTo175k_value_2010 / Total_value_2010 ) * 100) %&gt;%
mutate((  One75kTo200k_Percent_2010 =  One75kTo200k_value_2010 / Total_value_2010 ) * 100) %&gt;%
mutate(( Twohundredkto250k_Percent_2010 = Twohundredkto250k_value_2010 / Total_value_2010 ) * 100) %&gt;%
  mutate(( Twofiftykto300k_Percent_2010 = Twofiftykto300k_value_2010 / Total_value_2010 ) * 100) %&gt;%
  mutate(( Threehundredkto400k_Percent_2010 = Threehundredkto400k_value_2010 / Total_value_2010 ) * 100) %&gt;%
  mutate(( Fourhundredkto500k_Percent_2010 = Fourhundredkto500k_value_2010 / Total_value_2010 ) * 100) %&gt;%
  mutate(( Fivehundredkto750k_Percent_2010 = Fivehundredkto750k_value_2010 / Total_value_2010 ) * 100) %&gt;%
  mutate(( Sevenfiftykto1mil_Percent_2010 = Sevenfiftykto1mil_value_2010 / Total_value_2010 ) * 100) %&gt;%
  mutate(( OnemilPlus_Percent_2010 = OnemilPlus_value_2010 / Total_value_2010 ) * 100)

### Create GEOID of FIPS Code elements
value_geoid_2010 &lt;- paste0( value.pop.2010$state, value.pop.2010$county, value.pop.2010$tract)
value.pop.2010$geoid &lt;- value_geoid_2010

### Read csv file with only race variables. I manually created this by cutting and pasting the rows I wanted from the previous spreadsheet. 
value_2015_vars &lt;- read.csv(&quot;variable_lists/value_vars_2015.csv&quot;)

### Create Variable list based off variables in the first column
var.list.value.2015 &lt;- value_2015_vars$name

###Download data
value.pop.2015 &lt;- getCensus( name = &quot;acs/acs5&quot;, vintage = 2015,
                             key=censuskey,
                               vars = var.list.value.2015,
                               region=&quot;tract:*&quot;,
                             regionin=&quot;state:04&amp;county:013&quot; )

### Rename variables
value.pop.2015 &lt;- rename(value.pop.2015,
                         Total_value_2015=B25075_001E,
                        Lessthan10k_value_2015=B25075_002E, 
                        TenkTo14k_value_2015=B25075_003E,
                        Fifteenkto20k_value_2015=B25075_004E,
                        TwentykTo25k_value_2015=B25075_005E, 
                        TwentyfivekTo30k_value_2015=B25075_006E, 
                        ThirtykTo35k_value_2015= B25075_007E,
                       ThirtyfivekTo40k_value_2015=B25075_008E,
                       FortykTo50k_value_2015=B25075_009E,
                       FiftykTo60k_value_2015=B25075_010E,
                       SixtykTo70k_value_2015=B25075_011E, 
                       SeventykTo80k_value_2015=B25075_012E,
                       Eightykto90k_value_2015=B25075_013E,
                       Ninetykto100k_value_2015=B25075_014E,
                       OnehundredkTo125k_value_2015=B25075_015E, 
                     OnetwentyfivekTo150k_value_2015=B25075_016E,
                       OnefiftykTo175k_value_2015=B25075_017E, 
                       One75kTo200k_value_2015=B25075_018E, 
                       Twohundredkto250k_value_2015=B25075_019E, 
                       Twofiftykto300k_value_2015=B25075_020E, 
                       Threehundredkto400k_value_2015=B25075_021E,
                       Fourhundredkto500k_value_2015=B25075_022E, 
                       Fivehundredkto750k_value_2015=B25075_023E, 
                       Sevenfiftykto1mil_value_2015=B25075_024E, 
                       OnemiltoOnemilhalf_value_2015=B25075_025E,
                       Onemilhalfto2mil_value_2015=B25075_026E,
                       Twomilplus_value_2015=B25075_027E)

### Create percentage variables of each educational category
value.pop.2015 &lt;- value.pop.2015 %&gt;% group_by(tract) %&gt;% 
  mutate((Lessthan10k_Percent_2015 = Lessthan10k_value_2015 / Total_value_2015) * 100) %&gt;%
  mutate(( TenkTo14k_Percent_2015 = TenkTo14k_value_2015 / Total_value_2015) * 100) %&gt;%
mutate(( TenkTo14k_Percent_2015 = TenkTo14k_value_2015 / Total_value_2015) * 100) %&gt;% 
mutate(( Fifteenkto20k_Percent_2015 = Fifteenkto20k_value_2015 / Total_value_2015 ) * 100) %&gt;%
mutate(( TwentykTo25k_Percent_2015 = TwentykTo25k_value_2015 / Total_value_2015 ) * 100) %&gt;%
mutate(( TwentyfivekTo30k_Percent_2015 = TwentyfivekTo30k_value_2015 / Total_value_2015 ) * 100) %&gt;%
mutate(( ThirtykTo35k_2015 = ThirtykTo35k_value_2015 / Total_value_2015 ) * 100) %&gt;%
mutate(( ThirtyfivekTo40k_Percent_2015 = ThirtyfivekTo40k_value_2015  / Total_value_2015 ) * 100) %&gt;%
mutate(( FortykTo50k_Percent_2015 = FortykTo50k_value_2015 / Total_value_2015 ) * 100) %&gt;%
mutate(( FiftykTo60k_Percent_2015 = FiftykTo60k_value_2015 / Total_value_2015 ) * 100) %&gt;%
mutate(( SixtykTo70k_Percent_2015 = SixtykTo70k_value_2015 / Total_value_2015 ) * 100) %&gt;%
mutate((  Eightykto90k_Percent_2015 =  Eightykto90k_value_2015 / Total_value_2015 ) * 100) %&gt;%
mutate(( Ninetykto100k_Percent_2015 = Ninetykto100k_value_2015 / Total_value_2015 ) * 100) %&gt;%
mutate(( OnehundredkTo125k_Percent_2015 = OnehundredkTo125k_value_2015 / Total_value_2015 ) * 100) %&gt;%
mutate(( OnetwentyfivekTo150k_Percent_2015 = OnetwentyfivekTo150k_value_2015 / Total_value_2015 ) * 100) %&gt;%
mutate(( OnefiftykTo175k_Percent_2015 = OnefiftykTo175k_value_2015 / Total_value_2015 ) * 100) %&gt;%
mutate((  One75kTo200k_Percent_2015 =  One75kTo200k_value_2015 / Total_value_2015 ) * 100) %&gt;%
mutate(( Twohundredkto250k_Percent_2015 = Twohundredkto250k_value_2015 / Total_value_2015 ) * 100) %&gt;%
  mutate(( Twofiftykto300k_Percent_2015 = Twofiftykto300k_value_2015 / Total_value_2015 ) * 100) %&gt;%
  mutate(( Threehundredkto400k_Percent_2015 = Threehundredkto400k_value_2015 / Total_value_2015 ) * 100) %&gt;%
  mutate(( Fourhundredkto500k_Percent_2015 = Fourhundredkto500k_value_2015 / Total_value_2015 ) * 100) %&gt;%
  mutate(( Fivehundredkto750k_Percent_2015 = Fivehundredkto750k_value_2015 / Total_value_2015 ) * 100) %&gt;%
  mutate(( Sevenfiftykto1mil_Percent_2015 = Sevenfiftykto1mil_value_2015 / Total_value_2015 ) * 100) %&gt;%
  mutate(( Sevenfiftykto1mil_Percent_2015 = Sevenfiftykto1mil_value_2015 / Total_value_2015 ) * 100) %&gt;%
   mutate(( OnemiltoOnemilhalf_Percent_2015 = OnemiltoOnemilhalf_value_2015 / Total_value_2015 ) * 100) %&gt;%
    mutate(( Onemilhalfto2mil_Percent_2015 = Onemilhalfto2mil_value_2015 / Total_value_2015 ) * 100) %&gt;%
     mutate(( Twomilplus_Percent_2015 = Twomilplus_value_2015 / Total_value_2015 ) * 100)

##Geoid

###Create GEOID of FIPS Code elements
value_geoid_2015 &lt;- paste0( value.pop.2015$state, value.pop.2015$county, value.pop.2015$tract)

value.pop.2015$geoid &lt;- value_geoid_2015


# Number of units

# Occupancy

##2015
### Read csv file with only occupancy variables.
occupancy_vars_2015 &lt;- read.csv(&quot;variable_lists/occupancy_vars_2015.csv&quot;)</code></pre>
<pre><code>## Warning in read.table(file = file, header = header, sep = sep, quote =
## quote, : incomplete final line found by readTableHeader on 'variable_lists/
## occupancy_vars_2015.csv'</code></pre>
<pre class="r"><code>### Create Variable list based off variables in the first column
occupancy.list.age.2015 &lt;- occupancy_vars_2015$name

### Download the data
occupancy.pop.2015 &lt;- getCensus( name = &quot;acs/acs5&quot;, vintage = 2015,
                                 key=censuskey,
                               vars = occupancy.list.age.2015,
                               region=&quot;tract:*&quot;,
                               regionin=&quot;state:04&amp;county:013&quot; )

### Rename the variables
occupancy.pop.2015 &lt;- rename(occupancy.pop.2015,
                       Total_occupancy_2015= B25002_001E,
                         occupied_2015= B25002_001E,
                         vacant_2015= B25002_001E)

### Create GEOID of FIPS Code elements
occupancy_geoid_2015 &lt;- paste0( occupancy.pop.2015$state, occupancy.pop.2015$county, occupancy.pop.2015$tract)

occupancy.pop.2015$geoid &lt;- occupancy_geoid_2015

# Vacancy

## 2015 

### Read csv file with only vacancy variables. 
vacancy_vars_2015 &lt;- read.csv(&quot;variable_lists/vacancy_vars_2015.csv&quot;)

### Create Variable list based off variables in the first column
var.list.vacancy.2015 &lt;- vacancy_vars_2015$name

### Download the data
vacancy.pop.2015 &lt;- getCensus( name = &quot;acs/acs5&quot;, vintage = 2015,
                               key=censuskey,
                               vars = var.list.vacancy.2015,
                               region=&quot;tract:*&quot;,
                               regionin=&quot;state:04&amp;county:013&quot; )

## #Rename the variables
vacancy.pop.2015 &lt;- rename(vacancy.pop.2015, Total_vacancy_2015=B25004_001E,
                        For_rent_2015=B25004_002E, 
                        Rented_unoccupied_2015=B25004_003E,
                        Forsale_2015=B25004_004E,
                        Sold_unoccupied_2015=B25004_005E, 
                        Seasonaluse_2015=B25004_006E, 
                        Migrant_workers_2015= B25004_007E,
                       Other_vacant_2015=B25004_008E)

### Create percentages
vacancy.pop.2015 &lt;- vacancy.pop.2015 %&gt;% group_by(tract) %&gt;% 
  mutate((forsale_percent_2015 = Forsale_2015 / Total_vacancy_2015) * 100)

### Create GEOID of FIPS Code elements
vacancy_geoid_2015 &lt;- paste0( vacancy.pop.2015$state, vacancy.pop.2015$county, vacancy.pop.2015$tract)
vacancy.pop.2015$geoid &lt;- vacancy_geoid_2015


# Travel Time
## 2010 

### Read csv file with only travel time to work variables.
traveltime_vars_2010 &lt;- read.csv(&quot;variable_lists/traveltime_vars_2010.csv&quot;)

### Create Variable list based off variables in the first column
var.list.travel.2010 &lt;- traveltime_vars_2010$name

### Download the data
travel.pop.2010 &lt;- getCensus( name = &quot;acs/acs5&quot;, vintage = 2010,
                              key=censuskey,
                               vars = var.list.travel.2010,
                               region=&quot;tract:*&quot;,
                              regionin=&quot;state:04&amp;county:013&quot; )

### Rename the data
travel.pop.2010 &lt;- rename(travel.pop.2010, Total_travel_2010=B08303_001E,
                        Lessthan5_2010=B08303_002E, 
                        Fiveto9_2010=B08303_003E,
                        Tento14_2010=B08303_004E,
                        Fifteento19_2010=B08303_005E, 
                        Twentyto24_2010=B08303_006E, 
                        Twentyfiveto29_2010=B08303_007E,
                       Thirtyto34_2010=B08303_008E,
                       Thirtyfiveto39_2010=B08303_009E,
                       Fortyto44_2010=B08303_010E,
                       Fortyfiveto59_2010=B08303_011E,
                       Sixtyto89_2010=B08303_012E, 
                       Ninetyplus_2010=B08303_013E)

### Create GEOID of FIPS Code elements
travel_geoid_2010 &lt;- paste0( travel.pop.2010$state, travel.pop.2010$county, travel.pop.2010$tract)
travel.pop.2010$geoid &lt;- travel_geoid_2010

##2015

###Read csv file with only travel time to work variables. 
traveltime_vars_2015 &lt;- read.csv(&quot;variable_lists/traveltime_vars_2015.csv&quot;)

### Create Variable list based off variables in the first column
var.list.travel.2015 &lt;- traveltime_vars_2015$name

### Download the data
travel.pop.2015 &lt;- getCensus( name = &quot;acs/acs5&quot;, vintage = 2015,
                              key=censuskey,
                               vars = var.list.travel.2015,
                               region=&quot;tract:*&quot;,
                              regionin=&quot;state:04&amp;county:013&quot; )

###Rename the variables
travel.pop.2015 &lt;- rename(travel.pop.2015, Total_travel_2015=B08303_001E,
                        Lessthan5_2015=B08303_002E, 
                        Fiveto9_2015=B08303_003E,
                        Tento14_2015=B08303_004E,
                        Fifteento19_2015=B08303_005E, 
                        Twentyto24_2015=B08303_006E, 
                        Twentyfiveto29_2015=B08303_007E,
                       Thirtyto34_2015=B08303_008E,
                       Thirtyfiveto39_2015=B08303_009E,
                       Fortyto44_2015=B08303_010E,
                       Fortyfiveto59_2015=B08303_011E,
                       Sixtyto89_2015=B08303_012E, 
                       Ninetyplus_2015=B08303_013E)

### Geoid

### Create GEOID of FIPS Code elements
travel_geoid_2015 &lt;- paste0( travel.pop.2015$state, travel.pop.2015$county, travel.pop.2015$tract)
travel.pop.2015$geoid &lt;- travel_geoid_2015


#Load shapefiles

## Import Shapefile
download.file( &quot;https://github.com/lecy/neighborhood_change_phx/raw/master/shapefiles/tl_2010_04013_tract10.zip&quot;, 
&quot;maricopa-az-census_tract10.zip&quot; )
unzip( &quot;maricopa-az-census_tract10.zip&quot; )
file.remove( &quot;maricopa-az-census_tract10.zip&quot; )</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>library( rgdal )
phx &lt;- readOGR(&quot;tl_2010_04013_tract10.shp&quot;)</code></pre>
<pre><code>## OGR data source with driver: ESRI Shapefile 
## Source: &quot;/Users/abigailhenderson/Desktop/Capstone/neighborhood_change_phx/data/tl_2010_04013_tract10.shp&quot;, layer: &quot;tl_2010_04013_tract10&quot;
## with 916 features
## It has 12 fields
## Integer64 fields read as strings:  ALAND10 AWATER10</code></pre>
<pre class="r"><code>phx &lt;- spTransform( phx, CRS(&quot;+proj=longlat +datum=WGS84&quot;) )

phx$geoid2 &lt;- paste0( &quot;G&quot;, phx$STATEFP10, 
                     &quot;0&quot;, phx$COUNTYFP10, &quot;0&quot;, phx$TRACTCE10 )</code></pre>
<pre class="r"><code># Combine to match geoids
##ACS5
mcpa_educ_2010 &lt;- merge(phx, educ.pop.2010, by.x=&quot;GEOID10&quot;, by.y=&quot;geoid&quot;, all.x=T)
mcpa_income_2010 &lt;- merge(phx, income.pop.2010, by.x=&quot;GEOID10&quot;, by.y=&quot;geoid&quot;, all.x=T)
mcpa_value_2010 &lt;- merge(phx, value.pop.2010, by.x=&quot;GEOID10&quot;, by.y=&quot;geoid&quot;, all.x=T)
mcpa_travel_2010 &lt;- merge(phx, travel.pop.2010, by.x=&quot;GEOID10&quot;, by.y=&quot;geoid&quot;, all.x=T)


mcpa_race_2015 &lt;- merge(phx, race.pop.2015, by.x=&quot;GEOID10&quot;, by.y=&quot;geoid&quot;, all.x=T)
mcpa_educ_2015 &lt;- merge(phx, educ.pop.2015, by.x=&quot;GEOID10&quot;, by.y=&quot;geoid&quot;, all.x=T)
mcpa_income_2015 &lt;- merge(phx, income.pop.2015, by.x=&quot;GEOID10&quot;, by.y=&quot;geoid&quot;, all.x=T)
mcpa_occupancy_2015 &lt;- merge(phx, occupancy.pop.2015, by.x=&quot;GEOID10&quot;, by.y=&quot;geoid&quot;, all.x=T)
mcpa_sex_2015 &lt;- merge(phx, sex.pop.2015, by.x=&quot;GEOID10&quot;, by.y=&quot;geoid&quot;, all.x=T)
mcpa_vacancy_2015 &lt;- merge(phx, vacancy.pop.2015, by.x=&quot;GEOID10&quot;, by.y=&quot;geoid&quot;, all.x=T)
mcpa_value_2015 &lt;- merge(phx, value.pop.2015, by.x=&quot;GEOID10&quot;, by.y=&quot;geoid&quot;, all.x=T)
mcpa_travel_2015 &lt;- merge(phx, travel.pop.2015, by.x=&quot;GEOID10&quot;, by.y=&quot;geoid&quot;, all.x=T)

write.csv( NHGIS_data, &quot;NHGIS_data_rename1&quot;, row.names=F)

#Combine above datasets by year
###2010

phx.dat.2010.1 &lt;- merge(educ.pop.2010, income.pop.2010, by.x=&quot;geoid&quot;, by.y=&quot;geoid&quot;, all.x=T)

###Checked: nrow 916 consistent, length 23 + 61 = 84

phx.dat.2010.2 &lt;- merge(travel.pop.2010, value.pop.2010, by.x=&quot;geoid&quot;, by.y=&quot;geoid&quot;, all.x=T)

###Checked: nrow 916 consistent, length 17 + 30 = 46

phx.dat.2010 &lt;- merge(phx.dat.2010.1, phx.dat.2010.2, by.x=&quot;geoid&quot;, by.y=&quot;geoid&quot;, all.x=T)

###Checked: nrow 916 consistent, length 46 + 84 = 128

###2015
phx.dat.2015.1 &lt;- merge(race.pop.2015, educ.pop.2015, by.x=&quot;geoid&quot;, by.y=&quot;geoid&quot;, all.x=T)

###Checked: nrow 916 consistent, length 21 + 43 = 63

phx.dat.2015.2 &lt;- merge(occupancy.pop.2015, income.pop.2015, by.x=&quot;geoid&quot;, by.y=&quot;geoid&quot;, all.x=T)

###Checked: nrow 916 consistent, length 7 + 23 = 29

phx.dat.2015.3 &lt;- merge(sex.pop.2015, vacancy.pop.2015, by.x=&quot;geoid&quot;, by.y=&quot;geoid&quot;, all.x=T)

###Checked: nrow 916 consistent, length 7 + 12 = 18


phx.dat.2015.4 &lt;- merge(travel.pop.2015, value.pop.2015, by.x=&quot;geoid&quot;, by.y=&quot;geoid&quot;, all.x=T)

###Checked: nrow 916 consistent, length 7 + 32 = 38

phx.dat.2015.5 &lt;- merge(phx.dat.2015.1, phx.dat.2015.2, by.x=&quot;geoid&quot;, by.y=&quot;geoid&quot;, all.x=T)

###Checked: nrow 916 consistent, length 63 + 29 = 91

phx.dat.2015.6 &lt;- merge(phx.dat.2015.3, phx.dat.2015.4, by.x=&quot;geoid&quot;, by.y=&quot;geoid&quot;, all.x=T)

###Checked: nrow 916 consistent, length 18 + 38 = 55

phx.dat.2015 &lt;- merge(phx.dat.2015.5, phx.dat.2015.6, by.x=&quot;geoid&quot;, by.y=&quot;geoid&quot;, all.x=T, all.y=F)</code></pre>
<pre><code>## Warning in merge.data.frame(phx.dat.2015.5, phx.dat.2015.6, by.x =
## &quot;geoid&quot;, : column names '*....x', '*....y' are duplicated in the result</code></pre>
<pre class="r"><code>###Checked: nrow 916 consistent, length 55 + 107 = 162

#Combine datasets for 2010 and 2015

phx.dat &lt;- merge(phx.dat.2010, phx.dat.2015, by.x=&quot;geoid&quot;, by.y=&quot;geoid&quot;, all.x=T, all.y=F)</code></pre>
<pre><code>## Warning in merge.data.frame(phx.dat.2010, phx.dat.2015, by.x = &quot;geoid&quot;, :
## column names '*....x.y', '*....y.y' are duplicated in the result</code></pre>
<pre class="r"><code>write.csv( phx.dat, &quot;phx.dat.csv&quot;, row.names=F)

###Checked: nrow 916 consistent, length 128 + 161 = 288

#Combine ACS 5 datasets with NHGIS data

phx.dat$geoid3 &lt;- paste0( &quot;G&quot;, phx$STATEFP10, 
                     &quot;0&quot;, phx$COUNTYFP10, &quot;0&quot;, phx$TRACTCE10 )


phx.combined.data &lt;- merge(NHGIS_data, phx.dat, by.x=&quot;GISJOIN&quot;, by.y=&quot;geoid3&quot;, all.x=T, all.y=F)</code></pre>
<pre><code>## Warning in merge.data.frame(NHGIS_data, phx.dat, by.x = &quot;GISJOIN&quot;, by.y
## = &quot;geoid3&quot;, : column names '*....x.y', '*....y.y' are duplicated in the
## result</code></pre>
<pre class="r"><code>write.csv( phx.combined.data, &quot;phx.combined.data.csv&quot;, row.names=F)

###Checked: nrow 916 consistent, length 330 + 288 = 618</code></pre>
<pre class="r"><code>#Merge the combined dataset with the shapefile
phx.shape.data &lt;- merge(phx, phx.combined.data, by.x=&quot;geoid2&quot;, by.y=&quot;GISJOIN&quot;, all.x=T)

#Convert large data file into GeoJson &amp; write as GeoJson in shapefiles folder

geojson_write( phx.shape.data, file = &quot;../shapefiles/phx.geojson&quot; )</code></pre>
<pre><code>## Success! File is at ../shapefiles/phx.geojson</code></pre>
<pre><code>## &lt;geojson-file&gt;
##   Path:       ../shapefiles/phx.geojson
##   From class: SpatialPolygonsDataFrame</code></pre>
<pre class="r"><code>#Convert to tidy data

url &lt;- &quot;https://raw.githubusercontent.com/lecy/neighborhood_change_phx/master/data/archive/phx.dashboard.dat.csv&quot;
dat &lt;- read.csv( url, stringsAsFactors=F )

dat &lt;- gather(  dat, &quot;var_name&quot;, &quot;value&quot;, 5:71 )

dat &lt;- separate( dat, var_name, c(&quot;level&quot;, &quot;year&quot;)  )

write.csv(dat, &quot;tidy.dashboard.dat.csv&quot;, row.names=F)</code></pre>
<pre class="r"><code>#Convert shapefile to a dataframe for ggplot maps

library(broom)
phx_fortified &lt;- tidy( phx, region = &quot;geoid2&quot;)</code></pre>
<pre><code>## Warning in bind_rows_(x, .id): Unequal factor levels: coercing to character</code></pre>
<pre><code>## Warning in bind_rows_(x, .id): binding character and factor vector,
## coercing into character vector
